# 밥투게더 스펙 (기능정의 + ERD + API)

> 목적: Claude Code가 프로젝트 요구사항/데이터모델/엔드포인트를 빠르게 이해하고, 구현 시 일관된 결정을 내릴 수 있도록 만든 단일 스펙 문서.

## 0. 핵심 컨셉
- **그룹 기반**으로 사람들을 묶고, **약속(식사 모임)** 을 생성/관리한다.
- 약속에는 **장소(카카오맵 장소)** 가 연결된다.
- 약속/그룹에 대한 **초대**, 약속 내 **댓글**, 약속 종료 후 **리뷰 유도 알림**, **통계(월별 페어)** 를 제공한다.

## 1. 도메인 용어
- **User**: 서비스 사용자
- **Group**: 사용자들이 속한 모임(그룹)
- **Appointment**: 그룹 내 약속(모임 일정)
- **Place**: 장소(카카오맵 id 포함)
- **Invitation**: 그룹/약속 초대
- **Notification**: 알림 본문(타입/타겟/메시지/링크)
- **UserNotification**: 사용자별 알림 수신 상태(읽음/삭제)
- **(Join) GroupMember / AppointmentMember / UserPlace**: N:M 관계를 풀기 위한 조인 테이블

## 2. 기능 정의 (백로그 기반)

### Epic: 회원가입

로그인

로그아웃

#### Feature: 회원가입

- **Story:** 1. 사용자가 회원가입을 한다.
  - 1-1. 이메일:  xxx@xxx (중복여부 확인 필요) (P1, 해야함, @원재호)
  - 1-2. 비밀번호: (8~16자, 숫자/영문자/대문자/특수문자 조합) (P2, 하는중, @유현주)
  - 1-3. 비밀번호 확인 (위와 동일) (P3, 끝)
  - 1-4. 이름 (P4)
  - 1-5. 닉네임: 3~8자 (중복여부 확인) (P5)
  - 1-6. 핸드폰 번호: 11자리 숫자 입력 (중복여부 확인)

#### Feature: 로그인

- **Story:** 2. 사용자가 로그인한다.
  - 2-1. 아이디, 비밀번호를 입력해 로그인한다.
  - 2-2. 로그인이 정상적으로 되지 않았다면 alert
  - 2-3. 이메일이 유효하지 않으면 이메일 칸 밑에 빨간글씨로 "이메일 주소가 존재하지 않습니다"
  - 2-4. 비밀번호가 유효하지 않았다면 비밀번호 칸 밑에 빨간글씨로 "유효한 비밀번호가 아닙니다."

- **Story:** 3. 사용자가 이메일 찾기를 요청한다.
  - 3-1. 이름과 핸드폰번호를 입력해 DB에 존재하는 가입된 이메일을 보여준다.
  - 3-2. 해당 조합이 존재하지 않으면 alert. "가입된 이메일 정보가 존재하지 않습니다."

- **Story:** 4. 사용자가 비밀번호 찾기를 요청한다.
  - 4-1. DB에 이름과 이메일 조합이 존재하면 이메일로 비밀번호 재설정 수단 제공

- **Story:** 5. 로그인 성공
  - 5-1. 엑세스 토큰과 리프레시 토큰을 발급한다.
  - 5-2. 메인 페이지로 이동한다.

- **Story:** 6. 이미 로그인 했던 사용자가 새로고침 혹은 브라우저를 새로 열때
  - 6-1. 엑세스 토큰의 유효기간이 남아있다면 로그인상태로 접속한다.
  - 6-2. 엑세스 토큰의 유효기간이 지났다면 리프레시 토큰으로 엑세스 토큰을 재발급한다.
  - 6-3. 리프레시 토큰의 유효기간이 지났다면 재로그인을 하게한다.

#### Feature: 로그아웃

- **Story:** 7. 사용자가 로그아웃 버튼을 누른다.
  - 7-1. 쿠키에서 엑세스 토큰을, 로컬스토리지에서 리프레시 토큰을 삭제한다.
  - 7-2. DB에서 유저에게 발급한 리프레시 토큰, 엑세스 토큰을 무효화 한다.

### Epic: 그룹

#### Feature: 그룹 생성/수정

- **Story:** 1. 사용자가 그룹을 생성/수정한다.
  - 1-1. 그룹명
  - 1-2. 그룹 설명
  - 1-3. 그룹의 공개 비공개 여부를 설정한다.

#### Feature: 그룹 검색

- **Story:** 2. 사용자가 그룹을 검색한다.
  - 2-1. 그룹 이름으로 검색 한다.

#### Feature: 그룹 초대

- **Story:** 3. 사용자가 그룹에 다른 유저를 초대한다.
  - 3-1. 이메일로 다른 유저를 검색한다.
  - 3-2. 유저에게 그룹 가입 초대를 발송한다.

#### Feature: 그룹 관리

- **Story:** 4. 사용자가 그룹 멤버를 관리한다.
  - 4-1. 가입된 유저 명단을 페이지 네이션으로 확인한다.
  - 4-2. 가입된 유저를 검색할 수 있다.
  - 4-3. 가입된 유저를 그룹에서 추방할 수 있다.

#### Feature: 그룹 탈퇴

- **Story:** 5. 사용자가 그룹에서 탈퇴한다.
  - 5-1. 그룹에서 사용자를 제외한다.
  - 5-2. 그룹장에게 사용자가 탈퇴했다는 알람을 보낸다.

### Epic: 약속

#### Feature: 약속 생성/수정

- **Story:** 1. 사용자가 약속을 생성/수정한다.
  - 1-1. 약속명
  - 1-2. 약속 설명
  - 1-3. 장소를 검색해서 선택한다.
  - 1-4. 메뉴명 — 장소로 대체 가능
  - 1-5. 시작시간
  - 1-6. 종료시간
  - 1-7. 초대할 멤버를 검색해 추가한다.

#### Feature: 약속 확정

- **Story:** 2. 사용자가 약속을 확정하고 추가 인원 초대를 끝낸다.
  - 2-1. 확정 버튼을 누르면 약속이 확정 상태가 된다. (confirmed)

#### Feature: 약속 취소

- **Story:** 3. 사용자가 약속을 취소한다.
  - 3-1. 취소 버튼을 누르면 약속이 취소 상태가 되고 수정이 불가능 해진다.
  - 3-2. 해당 약속에 참여하고 있던 인원에게 약속 취소 알림이 발송된다.

#### Feature: 약속 종료

- **Story:** 4. 확정상태에 있는 약속의 종료시간이 지난다.
  - 4-1. 약속이 종료 상태가 된다. (ended)
  - 4-2. 약속에 참여한 인원에게 장소에 대한 리뷰 작성 알림이 발송된다.

- **Story:** 5. 사용자가 종료된 약속의 장소에 대한 리뷰를 작성한다.
  - 5-1. 평점
  - 5-2. 리뷰 내용

- **Story:** 6. 확정되지 않은 약속의 종료시간이 지난다.
  - 6-1. 약속에 참여한 인원에게 약속이 진행됬는지 묻는 알림이 발송된다. (pending)

- **Story:** 7. 사용자가 확정되지 않은 약속이 진행됬다고 답한다.
  - 7-1. 해당 약속을 종료처리하고 약속에 참여한 인원에게 리뷰 작성 알림이 발송된다. (ended)

- **Story:** 8. 사용자가 확정되지 않은 약속이 진행되지 않았다고 답한다.
  - 8-1. 해당 약속을 취소처리한다. (canceled)

#### Feature: 약속 댓글

- **Story:** 9. 사용자가 약속에 댓글을 작성한다.
  - 9-1. 댓글 내용

- **Story:** 10. 사용자가 약속에 댓글을 삭제한다.
  - 10-1. 댓글 삭제 버튼을 누르면 댓글을 삭제 처리한다.
  - 10-2. 해당 자리에 있던 곳에 "해당 댓글은 작성자에 의해 삭제되었습니다." 를 표시한다. — 사실 대댓글 기능이 없는데 이렇게 하는 것은 의미가 나이 데쓰요.

#### Feature: 약속 초대

- **Story:** 11. 사용자가 약속에 다른 유저를 초대한다.
  - 11-1. 이메일로 다른 유저를 검색한다. (조건: 같은 그룹에 있는 유저) — 닉네임, 이름으로도 조회 가능
  - 11-2. 해당 유저에게 약속 초대를 발송한다.

#### Feature: 약속 참여

- **Story:** 12. 사용자가 공개 약속에 참여한다.
  - 12-1. 해당 약속의 멤버가 된다.
  - 12-2. 약속의 주인에게 새로운 멤버 알람을 발송한다.

#### Feature: 약속 나가기

- **Story:** 13. 사용자가 참여한 약속에서 나간다.
  - 13-1. 해당 약속의 멤버에서 제외된다.
  - 13-2. 약속의 주인에게 나간 멤버 알람을 발송한다. — 너무 슬퍼요.. 거절하지뫄..
  - 13-3. — 약속장이 일이 있을 수도 있잖아요

#### Feature: 약속 검색

- **Story:** 14. 사용자가 약속을 검색한다.
  - 14-1. 약속 제목으로 검색

### Epic: 알람

#### Feature: 알람 확인

- **Story:** 1. 사용자가 알람을 확인함
  - 1-1. 최근 삭제하지 않은 알람을 리스트로 보여줌 (무한 스크롤)

- **Story:**  
  - 2-1. 각 알람을 클릭하면 큰 카드로 열어 알람을 보여줌
  - 2-2. 그룹 초대 알람일 경우 "ooo 님께서 oo그룹에 초대하셨습니다" (수락, 거절버튼)
  - 2-3. 리뷰 작성 요청 알람에는 "최근 약속에 다녀오신 ooo 장소는 어떠셨나요? 리뷰를 남겨주세요" (리뷰남기기 버튼)
  - 2-4. 약속 진행여부를 묻는 알람에는 "최근 oo 약속에 다녀오셨나요?" (예, 아니오 버튼)
  - 2-5. 약속에 달린 댓글 작성 알림일 경우 "ooo 님께서 약속에 댓글을 작성하셨습니다." (댓글 보러가기 버튼)
  - 2.6.

- **Story:** 3. 사용자가 알람을 삭제함
  - 2-7. 알람 상태값을 삭제로 바꿈

#### Feature: 알람 응답

- **Story:** 2. 사용자가 초대 알람에 수락 버튼을 누름.
  - 2-1. 그룹/약속 초대 알람에 수락하고 그룹/약속에 참여함
  - 2-2. 초대를 보낸 유저에게 결과 여부 알람을 보냄

- **Story:** 3. 사용자가 초대 알람에 거절 버튼을 누름.
  - 3-1. 그룹/약속 초대 알람을 거절하고 아무일도 일어나지 않음
  - 3-2. 초대를 보낸 유저에게 결과 여부 알람을 보냄

- **Story:** 4. 사용자가 리뷰 작성 하기 버튼을 누름
  - 4-1. 리뷰 작성페이지로 이동함

- **Story:** 5. 사용자가 약속 진행여부 알람에 예 버튼을 누름.
  - 5-1. 해당 약속이 즉시 종료 상태로 바뀜
  - 5-2. 약속 종료의 시나리오를 똑같이 이행함

- **Story:** 6. 사용자가 약속 진행여부 알람에 아니오 버튼을 누름.
  - 6-1. 해당 약속이 즉시 취소 상태로 바뀜
  - 6-2. 약속 취소의 시나리오를 똑같이 이행함

### Epic: 마이페이지

#### Feature: 정보 수정

- **Story:** 1. 사용자가 개인정보를 수정한다.
  - 1-1. 비밀번호 (동일한 비밀번호, 유효성 확인)
  - 1.2. 비밀번호 확인
  - 1-3. 닉네임
  - 1-4. 핸드폰번호
  - 1-5. 프로필 사진 추가/수정

#### Feature: 히스토리

- **Story:** 2. 사용자가 지금까지 다녀온 약속을 확인한다.
  - 2-1. 다녀온 약속들을 시간순으로 확인 (페이지 네이션)
  - 2-2. 지금까지 다녀온 장소들을 지도에서 확인

#### Feature: 그룹 확인

- **Story:** 3. 사용자가 속해있는 그룹을 확인한다.
  - 3-1. 그룹 명단

#### Feature: 약속 확인

- **Story:** 4. 사용자가 승인한 앞으로의 약속 목록을 확인한다.
  - 4-1. 약속 시간의 최신 순으로 확인 가능

### Epic: 통계

#### Feature: 통계 확인

- **Story:** 1. 사용자가 월별 통계를 확인한다.
  - 1-1. 이번달 가장많이 밥을 먹은 두사람과 횟수
  - 1-2. 이번달 가장 많이 방문한 식당
  - 1-3. 이번달 가장 많은 식당에 방문한 사람

- **Story:** 2. 사용자가 전체 통계를 확인한다.
  - 2-1. 평점이 가장 높은 식당

### Epic: 장소

#### Feature: 장소 검색

- **Story:** 1. 사용자가 주소/키워드로 장소를 검색한다.
  - 1-1. 카카오 API 응답으로 받은 주소를 지도위에서 확인한다.
  - 1-2. 지도위 마커에 마우스를 올리면 장소 미리보기를 확인할 수 있다.
  - 1-3.

- **Story:** 2. 사용자가 장소 정보를 확인한다.
  - 2-1. 해당 식당에 최근 방문한 그룹원의 리뷰가 확인 가능하다. (최신 정렬)
  - 2-2. 해당 식당에 가장 많이 방문한 사람을 확인 가능하다. (닉네임과 프사)
  - 2-3. 유저가 이전에 다녀온 장소라면 방문횟수 확인
  - 2-4. 해당 장소의 카카오 평점 확인 — api 조회 불가능
  - 2-5. 해당 장소의 유저 평점 확인
  - 2-6. 해당 장소의 영업 정보 확인 — api 로 조회 불가능
