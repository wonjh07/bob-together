# AI Changelog (Rolling)

## 2026-02-04
- Added a sliding indicator animation to the search type toggle and aligned segments to equal widths.
- Documented DESIGN_SCAN.md usage in AGENTS.md and added it to the AI docs index.
- Added a search input component to the dashboard search page based on the design scan image.
- Removed mobile tap highlight and default button chrome from the search type toggle.
- Tuned the search toggle indicator transition to a springy cubic-bezier easing.
- Added appointment search result card/list components with dummy data for the search page.
- Added the missing appointment title line to the search result card.
- Added group search result card/list components with dummy data on the search page.
- Added a title line to the group search result cards.
- Wired the search type toggle to switch between appointment and group results via a client wrapper.
- Added TanStack Query provider and migrated the appointment list to useInfiniteQuery (client-only).
- Fixed React Query type errors and lint ordering warnings after the migration.
- Added SSR prefetch + HydrationBoundary for the dashboard appointment list.
-- Reverted server QueryClient util extraction (inlined again in dashboard page).
- Added shared appointment query keys utility for SSR/client consistency.
- Documented always considering type-check/lint in AGENTS.md and fixed query key typing.
- Extracted client QueryClient defaults into a utility and wired Providers to use it.
- Shared appointment list query options between SSR prefetch and client list.
- Added group query keys and group query options utilities.
- Switched dashboard group dropdown to useQuery and slimmed GroupProvider to selection state only.
- Prefetched group list data on the dashboard to hydrate the group dropdown.
- Switched create appointment flow to use group queries via the client component and synced provider state.
- Standardized create appointment step components to use `import * as styles` and documented the rule in STYLE_GUIDE.
- Refactored appointment creation to store draft data in provider and move step-specific state/handlers into each step.
- Migrated appointment create flow to react-hook-form with FormProvider/useFormContext and step-level validation.
- Centralized appointment schema usage by reusing `src/schemas/appointment.ts` in the create form types.
- Added Zod schema validation for appointment create form and wired zodResolver.
- Standardized dashboard css imports to `import * as styles` within `(app)/dashboard`.
- Inlined create-appointment group loading into the create page and removed the route layout wrapper.
- Renamed the appointment create client component to `MultiStepFormClient`.
- Split appointment create schema into a base schema and derived UI/server schemas.
- Moved time-order validation to UI-only schema and left server checks in action logic.
- Removed the duplicate PlaceStep next button to prevent skipping validation.
- Added loading/empty-state handling for group selection in the create flow.
- Limited ConfirmStep subscriptions to needed fields with useWatch.
- Added profile summary and quick-link components to the dashboard profile page.
- Set appointment create default date/time to now and +1 hour.
- Moved default date/time helper to `src/utils` and ensured DateTimeStep applies defaults.

## 2026-02-03
- Added dashboard appointment list with GroupContext for shared group selection state.
- Created `listAppointmentsAction` with cursor-based pagination, period/type filters.
- Added `useInfiniteScroll` hook with IntersectionObserver for infinite scroll.
- Created filter components: `PeriodFilter` (dropdown), `TypeFilter` (chip buttons).
- Created `AppointmentCard` with status badges (confirmed/pending/canceled), participant info, edit button.
- Created `AppointmentList` integrating filters, cards, and infinite scroll.
- Refactored `TopNav` to use `useGroupContext()` instead of props.
- Wrapped app layout children with `GroupProvider` for shared group state.
- Updated dashboard page to render `AppointmentList` component.
- Switched onboarding back button control to a route-based client gate and removed onboarding layout context usage.
- Converted onboarding group completion pages to Server Components using `searchParams` props.
- Split onboarding login into a Server page with a client `LoginForm` component to reduce `use client` scope.
- Split onboarding signup into a Server page with a client `SignupForm` component and moved root error styling to CSS.
- Split onboarding group create into a Server page with a client `GroupCreateForm` component.
- Split onboarding group invitation into a Server page with a client `GroupInvitationClient` for search/invite interactions.
- Split onboarding group join into a Server page with a client `GroupJoinClient` for search and navigation interactions.
- Split onboarding group join confirm into a Server page with a client `GroupJoinConfirmClient`, moving the join action to the client and resolving group name on the server when possible.
- Added `FormError` UI component and replaced the signup root error inline style with the shared component.
- Added `getActionErrorMessage` utility and adopted it across onboarding client actions for consistent error handling.
- Added group selection cookie actions to persist the selected group across navigations.
- Updated `GroupProvider` to persist selected group changes into cookies.
- Updated app layout to initialize group selection from the persisted cookie when available.
- Updated appointment create layout to initialize group selection from the persisted cookie when available.
- Guarded appointment creation to require a selected group.
- Moved cookie read helper to a server-only module to avoid client import issues.
- Removed group dropdown usage from `TopNav` in preparation for moving group selection to the dashboard page.
- Moved `GroupProvider` and group list initialization to the dashboard page.
- Added dashboard header with group dropdown for group selection.
- Added group selection step with a new dropdown in appointment create flow.
- Added new AI docs: DECISIONS, CODEMAP, ACTIONS, ERRORS_AND_LESSONS and registered them in INDEX.
- Removed outdated CONTEXT_SESSION.md and unlinked it from INDEX.
- Trimmed GROUP_FLOW.md to focus on routes, actions, and shared styles.
- Trimmed and updated APPOINTMENTS_FLOW.md to reflect current entry points and routes.
- Updated CONTEXT_ROUTES.md to match current route structure and appointment step locations.
- Merged CONTEXT_TROUBLESHOOTING.md into ERRORS_AND_LESSONS.md and removed the old file.
- Merged CONTEXT_ROUTES.md into CODEMAP.md and removed the standalone routes doc.
- Centralized action lists in ACTIONS.md and removed action sections from flow docs.
- Recorded recent decisions in DECISIONS.md (without impact/verification sections).
- Renamed context docs: PROJECT.md, GROUP_FLOW.md, APPOINTMENTS_FLOW.md, KAKAO_INTEGRATION.md, DB_RLS.md.
- Merged GROUP_FLOW.md and APPOINTMENTS_FLOW.md into FLOWS.md and removed the originals.
- Removed unused TEMPLATE.md and TEMPLATE_EN.md from ai_docs.
- Removed unused scripts/update_ai_docs.sh.
- Removed getActionErrorMessage utility and restored direct result handling.
- Split appointment create page into a Server page with a client AppointmentCreateClient.
- Extracted current location logic into `useCurrentLocation` hook for appointment creation.
- Extracted place search logic into `usePlaceSearch` hook for appointment creation.
- Moved group selection cookie helper to `src/libs/server` and updated imports.
- Added search page header toggle UI based on the design scan.
- Added active toggle state and transition animation for the search type switch.
- Split appointment invitation page into a Server page and a client `AppointmentInvitationClient`.

## 2026-02-02 (late)
- Moved appointment routes from `(app)` to `(app-plain)` for step-based flow layout.
- Updated CONTEXT_ROUTES.md to reflect new route structure.

## 2026-02-02
- Added group onboarding flow pages and server actions.
- Added group RLS migration and middleware group gate for dashboard.
- Added Kakao map loader/hook/preview and place search action.
- Added appointment create/invite flow pages and actions.
- Added shared docs and tests for new actions.
- Limited appointment place result list height with internal scroll and left-aligned result cards.
- Moved appointment place map preview below search area, outside result cards.
- Split appointment create steps into separate components for each step.
- Added current location permission flow and distance-based place search input support.
- Added RLS policies for places/appointments/appointment_members to allow appointment creation flows.
- Added server-side logging for appointment creation failures to surface place/appointment errors.
- Moved appointment create group fetch to server page and introduced a client wrapper component to avoid double POST in dev.
- Moved app layout group fetch to server and passed groups into TopNav to avoid duplicate POSTs.
- Added Kakao map SDK preload in app layout to reduce first-map load latency.
- Cleared Kakao map container on updates to prevent previous map layers from overlapping.
- Moved appointment create data fetch into a route layout with context and made the page the UI entry point.
- Reused the existing Moveback component for appointment step navigation.
- Split appointment create step styles into per-step .css.ts files and slimmed page.css.ts.
- Restored place map preview rendering inside the place step after refactors.
- Reverted Moveback changes and reused its existing styles for the create step back button.
- Fixed onboarding signup router hook to use next/navigation in App Router.
- Added AI styling rules doc for Vanilla Extract and layout conventions.
- Added rules-by-example section to the styling guide.
- Refreshed context docs for appointments, Kakao, routes, session notes, and troubleshooting.
- Added Kakao map preview to the appointment confirm step.

## 2026-02-02 (docs)
- Added CONTEXT_SESSION/DB_RLS/ROUTES/TROUBLESHOOTING.
- Added update helper script and refreshed INDEX entries.
